!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("tslib"),require("@angular/core"),require("plotly.js"),require("@angular/common")):"function"==typeof define&&define.amd?define("@n-fuse/ng-plotly",["exports","tslib","@angular/core","plotly.js","@angular/common"],e):e(t.nfLib={},t.tslib,t.ng.core,null,t.ng.common)}(this,function(t,i,o,s,e){"use strict";var n="resize",r="plotId",a="plotClass",l="data",u="layout",h="configuration",c="events",g="frames",d="width",p="height",y={None:0,Restyle:1,Relayout:2,Resize:3,Update:4,Redraw:5,Recreate:6};y[y.None]="None",y[y.Restyle]="Restyle",y[y.Relayout]="Relayout",y[y.Resize]="Resize",y[y.Update]="Update",y[y.Redraw]="Redraw",y[y.Recreate]="Recreate";var f=function(){function e(t){var e=this;this.cd=t,this.afterPlot=!1,this.debug=!1,this.onResizeTimeOut=200,this.plotId="",this.plotClass="";var o=this.tag+".constructor()";this.debug&&console.log(o),this.resizeHandler=function(){var t=e.tag+".resizeHandler()";e.resizing&&(e.debug&&console.log(t,"clearTimeout("+e.resizing+")"),clearTimeout(e.resizing)),e.resizing=setTimeout(function(){return e.resize()},e.onResizeTimeOut)}.bind(this)}return e.prototype.ngOnInit=function(){this.tag=e.Tag+"."+this.plotId;var t=this.tag+".ngOnInit()";this.debug&&console.log(t)},e.prototype.ngAfterViewInit=function(){var t=this,e=this.tag+".ngAfterViewInit()";this.debug&&console.log(e),setTimeout(function(){return t.recreate()})},e.prototype.ngOnChanges=function(t){var e=this,o=this.tag+".ngOnChanges()";if(this.plot){this.debug&&console.log(o,"changes:",t);var n=Object.keys(t);_(n,[d,p])&&(this.changeAction=y.Resize),_(n,[u,r,a])&&(this.changeAction=y.Relayout),v(n,l)&&(this.changeAction=y.Redraw),_(n,[h,c,g])&&(this.changeAction=y.Recreate),setTimeout(function(){return e.applyChanges()})}else this.debug&&console.log(o,"ignoring changes, plot not yet once initialized")},e.prototype.applyChanges=function(){var t=this.tag+".applyChanges()";switch(this.debug&&console.log(t,"this.changeAction:",y[this.changeAction]),this.changeAction){case y.Resize:this.resize();break;case y.Relayout:this.relayout();break;case y.Redraw:this.redraw();break;case y.Recreate:this.recreate()}this.changeAction=y.None},e.prototype.restyle=function(o,n){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".restyle()",this.debug&&console.log(e,"update:",o),this.debug&&console.log(e,"traces:",n===undefined?"all":n),[2,s.restyle(this.plot,o,n)]})})},e.prototype.resize=function(o){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=this.tag+".resize()",this.debug&&console.log(e,"event:",o),[4,s.Plots.resize(this.plot)];case 1:return t.sent(),[2]}})})},e.prototype.relayout=function(o){return void 0===o&&(o=this.layout),i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=this.tag+".relayout()",this.debug&&console.log(e,"layout:",o),[4,s.relayout(this.plot,o)];case 1:return t.sent(),[2]}})})},e.prototype.update=function(o,n){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".update()",this.debug&&console.log(e,"dataUpdate:",o),this.debug&&console.log(e,"layoutUpdate:",n),[2,s.update(this.plot,o,n)]})})},e.prototype.redraw=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".redraw()",this.debug&&console.log(e),this.plot.data=this.data,this.plot.layout=this.layout,[2,s.redraw(this.plot)]})})},e.prototype.recreate=function(){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){switch(t.label){case 0:return e=this.tag+".recreate()",this.debug&&console.log(e),this.removeEventListeners(),this.plot=document.getElementById(this.plotId),this.width&&(this.plot.style.width=this.width+"%",this.plot.style["margin-left"]=(100-this.width)/2+"%"),this.height&&(this.plot.style.height=this.height+"%",this.plot.style["margin-top"]=(100-this.height)/2+"%"),this.debug&&console.log(e,"this.plot:",this.plot),[4,s.newPlot(this.plot,{data:this.data,layout:this.layout,config:this.configuration,frames:this.frames})];case 1:return t.sent(),this.width||this.height?(this.debug&&console.log(e,"resizing"),[4,this.resize()]):[3,3];case 2:t.sent(),this.afterPlot=!0,t.label=3;case 3:return this.attachEventListeners(this.plot,this.events),[2]}})})},e.prototype.attachEventListeners=function(t,i){var r=this,e=this.tag+".attachEventListeners()";this.debug&&console.log(e,"events:",i),Object.keys(i||{}).forEach(function(o){var n=r.tag+"."+o+"()";r.plot.on(o,function(t,e){r.debug&&console.log(n,"data:",t),r.debug&&console.log(n,"event:",e),i[o](t,e,r,s)})}),window.addEventListener(n,this.resizeHandler)},e.prototype.removeEventListeners=function(){var t=this.tag+".removeEventListeners()";this.debug&&console.log(t),window.removeEventListener(n,this.resizeHandler)},e.prototype.addTraces=function(o,n){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".addTraces()",this.debug&&console.log(e,"traces:",o),this.debug&&console.log(e,"index:",n),[2,s.addTraces(this.plot,o,n)]})})},e.prototype.deleteTraces=function(o){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".deleteTraces()",this.debug&&console.log(e,"traces:",o),s.deleteTraces(this.plot,o),[2]})})},e.prototype.animate=function(o,n){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".animate()",this.debug&&console.log(e,"update:",o),this.debug&&console.log(e,"animation:",n),[2,s.animate(this.plot,o,n)]})})},e.prototype.addFrames=function(o,n){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".addFrames()",this.debug&&console.log(e,"frames:",o),this.debug&&console.log(e,"indices:",n),[2,s.addFrames(this.plot,o,n)]})})},e.prototype.deleteFrames=function(o){return i.__awaiter(this,void 0,void 0,function(){var e;return i.__generator(this,function(t){return e=this.tag+".deleteFrames()",this.debug&&console.log(e,"frames:",frames),[2,s.deleteFrames(this.plot,o)]})})},e.prototype.ngOnDestroy=function(){var t=this.tag+".ngOnDestroy()";this.debug&&console.log(t),this.removeEventListeners()},e.Tag="PlotlyComponent",e.decorators=[{type:o.Component,args:[{selector:"plotly",template:'<div\n  id="{{ plotId }}"\n  class="{{ plotClass }}">\n</div>\n',changeDetection:o.ChangeDetectionStrategy.OnPush,host:{"[style.width]":'"100%"',"[style.height]":'"100%"'}}]}],e.ctorParameters=function(){return[{type:o.ChangeDetectorRef}]},e.propDecorators={debug:[{type:o.Input}],onResizeTimeOut:[{type:o.Input}],plotId:[{type:o.Input}],plotClass:[{type:o.Input}],data:[{type:o.Input}],layout:[{type:o.Input}],configuration:[{type:o.Input}],events:[{type:o.Input}],frames:[{type:o.Input}],width:[{type:o.Input}],height:[{type:o.Input}]},e}();function v(t,e){return-1!==t.indexOf(e)}function _(e,t){return t.some(function(t){return v(e,t)})}var m=function(){function t(){}return t.decorators=[{type:o.NgModule,args:[{imports:[e.CommonModule],exports:[f],declarations:[f],providers:[]}]}],t}();t.PlotlyModule=m,t.PlotlyComponent=f,t.PlotlyEvent={Hover:"plotly_hover",Unhover:"plotly_unhover",Click:"plotly_click",DoubleClick:"plotly_doubleclick",ClickAnnotation:"plotly_clickannotation",AfterPlot:"plotly_afterplot",Redraw:"plotly_redraw",Restyle:"plotly_restyle",Relayout:"plotly_relayout",Selecting:"plotly_selecting",Selected:"plotly_selected",Deselect:"plotly_deselect"},Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=n-fuse-ng-plotly.umd.min.js.map